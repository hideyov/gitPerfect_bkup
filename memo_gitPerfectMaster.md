# もう怖くないGit! チーム開発で必要なGitを完全マスター! 山浦講師

## Gitの設定

.gitconfig に登録したnameとemail

$ git config --global user.name [name]

git で使うエディターを登録 => $ git config --global core.editor "atom --wait"

設定の確認 => $ git config user.name, $ git config user.email

一度に確認したければ => $ git config --list

## Gitは差分でなく、スナップショットを保存している

branchを切る際やmergeする際に、スナップショットだと作業が早い。差分だと、いちいち計算しないといけない。

コミットが、直前のコミットを記録している。

## gitの作業の流れ

ワークツリーでファイルを変更

git add：コミットする変更を準備(記録したい変更分だけをstageに切り分けておく)

git commit：ステージに追加された変更を、スナップショットとしてリポジトリに記録

## コマンドの裏で何が起きているのか〜Gitのデータの持ち方（コミットまでの流れ）

### index.htmlをステージに追加する時、何が起こっているか。

index.html の圧縮ファイルAをリポジトリに保存。（実際は、ファイルの中身にヘッダを付け加えた文字列を、ハッシュ関数で暗号化した文字列がファイル名となる）

git add == ファイル名(index.html)と圧縮ファイルA（ファイルの中身）をmappingした情報をインデックスに保存。

git commit == インデックスのファイル構成を元に、ツリー1というファイルが作られる。次にコミット1というファイルを作る。

コミット1には、ツリー１（ファイル名）、作成者、日付、コミットメッセージが記録される。コミット1から、その時のファイル状態(snap shot)と、誰がいつ何のために変更したのかがわかる。

gitはステージに追加してコミットする際、圧縮ファイル、ツリー、コミットという3種類のファイルを作成してデータを保存している。

### 新しいファイル、css/home.cssを追加したら

git add == css/home.cssの圧縮ファイルBが作成される。インデックスにファイル構成を追記する。

git commit == ツリー2が作成され、インデックスに記載されているファイル構成が保存される。コミット2が作成され、ツリー2というツリー名が記録される。直前のコミット（コミット1）を、自分の親コミットとして記録する。（変更履歴を連鎖してたどれるように）

ステージに追加した時はインデックスという一つのファイルに上書きしておいて、コミット（きちんと記録）する時だけ、ツリーというファイルに保存する。

### ファイルを変更したら（セッション3　レクチャー16　3:00時点）

index.htmlだけを変更すると、index.htmlを圧縮した圧縮ファイルCのみがつくられる（圧縮ファイルは、ファイルの中身が違う時だけつくられる）。

インデックスファイルの情報が、index.htmlの圧縮ファイルがAからCに書き換えられる。ここまでが　[$ git add]

ツリー3が作成され、コミット3のツリーはツリー3、親コミットはコミット2となる。[$ git commit]

### Gitのデータ構造のまとめ

リポジトリに「圧縮ファイル」「ツリー」「コミット」ファイルを作成することでデータを保存。ステージに追加する時に「圧縮ファイル」が、コミットする時に「ツリー」「コミット」ファイルが作られる。

コミットが、親コミットへの参照を持つことで、変更履歴をたどることができる。

Gitの本質は、データを圧縮して、スナップショットで保存していること。

## .gitの中身は？

$ ls .git =>  COMMIT_EDITMSG  HEAD  config  description  hooks  index  info  logs  objects  refs

objects：圧縮ファイルやツリーファイル、コミットファイルが保存される、リポジトリの本体

config：Gitの設定ファイル。

## GitHub上にすでにあるプロジェクトから始める

$ git clone <リポジトリ名> => リモートリポジトリのファイルがワークツリーにコピーされ、.gitリポジトリがコピーされる。

### 変更を記録する(commit)

~$ git commit ：Gitのテキストエディターが立ち上がって、メッセージ付きで保存

~$ git commit -m <message>：いちいち、エディターを立ち上げなくて済む

~$ git commit -v ：エディターが立ち上がり、ファイルの変更内容を確認することができる。

### コミットメッセージの正式な書き方

1行目＝変更内容の要約、2行目＝改行、3行目＝変更した理由（チーム内、オープンソースへのコミットには正式な記法で！）

### 現コミットやステージ追加の前に、どのファイルが変更されたか確認する！

git status => ワークツリーとステージ、ステージとリポジトリの間で変更されたファイルを表示している。

### 変更差分を確認する

$ git diff (<ファイル名>)：git add する前の変更分を確認（ワークツリート、ステージの変更差分）

$ git diff --staged：git add した後の変更分を確認（ステージとコミットの変更差分）








